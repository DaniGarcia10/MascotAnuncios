<div class="registro-wrapper position-relative d-flex flex-column flex-grow-1">
  <div class="d-flex flex-column flex-lg-row flex-grow-1 px-3 py-5">
    <!-- Men√∫ lateral -->
    <div class="menu-lateral p-3 col-12 col-lg-3 mb-3 mb-lg-0">
      <ul class="list-group shadow-lg">
        <li class="list-group-item" [class.active]="activeSection === 'registro'" (click)="setActiveSection('registro')"
          *ngIf="!documentacion || documentacion?.estado === 'RECHAZADO'">
          Registrar criadero
        </li>
        <li class="list-group-item" [class.active]="activeSection === 'verificacion'"
          (click)="setActiveSection('verificacion')" *ngIf="documentacion">
          Estado de la verificaci√≥n
        </li>
      </ul>
      <!-- Nota explicativa para publicar anuncios -->
      <div class="alert alert-info mt-2 small" role="alert">
        <b>Nota:</b> Para poder publicar anuncios en la plataforma, primero debes registrar tu criadero y completar la
        verificaci√≥n.
      </div>
    </div>
    <!-- Contenido principal -->
    <div class="contenido-principal flex-grow-1 p-0 col-12 col-lg-9">
      <div *ngIf="activeSection === 'registro'">
        <!-- ...todo el formulario de registro actual aqu√≠... -->
        <div class="card custom-card w-100 mx-auto" style="max-width: 600px;">
          <div class="card-header custom-card-header text-center">
            <h3 class="card-title-grande">Registro del criadero</h3>
          </div>
          <div class="card-body custom-card-body">
            <form [formGroup]="formRegistro" (ngSubmit)="onSubmit()">
              <div class="mb-3">
                <label for="telefono" class="form-label">Tel√©fono:</label>
                <input id="telefono" formControlName="telefono" type="text" class="form-control"
                  placeholder="Ingresa tu tel√©fono" required>
                <div *ngIf="formRegistro.get('telefono')?.invalid && formRegistro.get('telefono')?.touched"
                  class="text-danger">
                  <small *ngIf="formRegistro.get('telefono')?.errors?.['required']">El tel√©fono es
                    obligatorio.</small>
                  <small *ngIf="formRegistro.get('telefono')?.errors?.['pattern']">Solo se permiten
                    n√∫meros.</small>
                  <small *ngIf="formRegistro.get('telefono')?.errors?.['maxlength']">M√°ximo 15 caracteres
                    permitidos.</small>
                </div>
              </div>
              <div formGroupName="criadero">
                <h5 class="mt-3">Datos del Criadero</h5>
                <div class="mb-3">
                  <label for="nucleo-zoologico" class="form-label">N√∫cleo Zool√≥gico:</label>
                  <input id="nucleo-zoologico" formControlName="nucleo_zoologico" type="text" class="form-control"
                    placeholder="Ingresa el n√∫cleo zool√≥gico">
                  <div
                    *ngIf="formRegistro.get('criadero.nucleo_zoologico')?.invalid && formRegistro.get('criadero.nucleo_zoologico')?.touched"
                    class="text-danger">
                    <small *ngIf="formRegistro.get('criadero.nucleo_zoologico')?.errors?.['required']">El
                      n√∫cleo zool√≥gico
                      es obligatorio.</small>
                    <small *ngIf="formRegistro.get('criadero.nucleo_zoologico')?.errors?.['pattern']">Solo
                      se permiten
                      caracteres alfanum√©ricos.</small>
                    <small *ngIf="formRegistro.get('criadero.nucleo_zoologico')?.errors?.['minlength']">Debe
                      tener
                      exactamente mas de 10 caracteres.</small>
                    <small *ngIf="formRegistro.get('criadero.nucleo_zoologico')?.errors?.['maxlength']">Debe
                      tener
                      exactamente 18 caracteres.</small>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="criadero-nombre" class="form-label">Nombre del Criadero:</label>
                  <input id="criadero-nombre" formControlName="nombre" type="text" class="form-control"
                    placeholder="Ingresa el nombre del criadero" required>
                  <div
                    *ngIf="formRegistro.get('criadero.nombre')?.invalid && formRegistro.get('criadero.nombre')?.touched"
                    class="text-danger">
                    <small *ngIf="formRegistro.get('criadero.nombre')?.errors?.['required']">El nombre del
                      criadero es
                      obligatorio.</small>
                    <small *ngIf="formRegistro.get('criadero.nombre')?.errors?.['maxlength']">M√°ximo 50
                      caracteres
                      permitidos.</small>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="criadero-ubicacion" class="form-label">Ubicaci√≥n del Criadero:</label>
                  <input id="criadero-ubicacion" formControlName="ubicacion" type="text" class="form-control"
                    placeholder="Ingresa la provincia del criadero">
                  <div
                    *ngIf="formRegistro.get('criadero.ubicacion')?.invalid && formRegistro.get('criadero.ubicacion')?.touched"
                    class="text-danger">
                    <small *ngIf="formRegistro.get('criadero.ubicacion')?.errors?.['required']">La ubicaci√≥n
                      es
                      obligatoria.</small>
                    <small *ngIf="formRegistro.get('criadero.ubicacion')?.errors?.['maxlength']">M√°ximo 100
                      caracteres
                      permitidos.</small>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="fotoPerfilCriadero" class="form-label">Foto de Perfil del Criadero:</label>
                  <input id="fotoPerfilCriadero" type="file" class="form-control"
                    (change)="onFileSelectedCriadero($event)">
                  <div
                    *ngIf="formRegistro.get('criadero.fotoPerfilCriadero')?.invalid && formRegistro.get('criadero.fotoPerfilCriadero')?.touched"
                    class="text-danger">
                    <small>La foto de perfil del criadero es obligatoria.</small>
                  </div>
                </div>
                <!-- Bloque de verificaci√≥n de criadero profesional -->
                <div class="mt-4 p-3 border rounded">
                  <h5 class="mb-2">Verificaci√≥n de Criadero Profesional</h5>
                  <p class="mb-2">
                    Para poder publicar anuncios necesitamos verificar tu identidad y autorizaci√≥n legal,
                    para as√≠
                    garantizar la confianza de los compradores.<br>
                    Revisaremos tu documentaci√≥n en menos de 24 horas.
                  </p>

                  <div class="mb-2">
                    <span class="fw-bold">üìë Documentaci√≥n obligatoria:</span>
                    <ul class="mb-1">
                      <li>DNI/NIE del titular (anverso y reverso en una sola imagen o PDF)</li>
                      <li>Certificado de inscripci√≥n en el Registro de N√∫cleos Zool√≥gicos (imagen o pdf del documento del nucleo zool√≥gico)</li>
                    </ul>
                  </div>

                  <div class="mb-3">
                    <label class="fw-bold">üì§ DNI / NIE</label>
                    <input type="file" class="form-control mt-1" accept=".pdf,.jpg,.jpeg,.png"
                      (change)="onDniFileSelected($event)">
                    <small class="text-muted">PDF, JPG o PNG ‚Äì m√°x. 20MB</small>
                    <div *ngIf="formRegistro.get('dniFile')?.invalid && formRegistro.get('dniFile')?.touched"
                      class="text-danger mt-1">
                      <small>El DNI/NIE es obligatorio.</small>
                    </div>
                    <div *ngIf="serverErrorDni" class="text-danger mt-1">
                      <small>{{ serverErrorDni }}</small>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label class="fw-bold">üì§ N√∫cleo Zool√≥gico</label>
                    <input type="file" class="form-control mt-1" accept=".pdf,.jpg,.jpeg,.png"
                      (change)="onNzFileSelected($event)">
                    <small class="text-muted">PDF, JPG o PNG ‚Äì m√°x. 20MB</small>
                    <div *ngIf="formRegistro.get('nzFile')?.invalid && formRegistro.get('nzFile')?.touched"
                      class="text-danger mt-1">
                      <small>El certificado del N√∫cleo Zool√≥gico es obligatorio.</small>
                    </div>
                    <div *ngIf="serverErrorNz" class="text-danger mt-1">
                      <small>{{ serverErrorNz }}</small>
                    </div>
                  </div>

                  <div class="mb-2">
                    <span class="fw-bold">‚úÖ Importante:</span>
                    <ul class="mb-1">
                      <li>La informaci√≥n debe coincidir con el titular de la cuenta.</li>
                      <li>Nos reservamos el derecho de rechazar documentos ilegibles o inv√°lidos.</li>
                    </ul>
                  </div>

                  <div>
                    Una vez verificado, tus anuncios aparecer√°n como ‚ÄúCriadero verificado‚Äù y podr√°s destacar
                    tus cachorros.
                  </div>
                </div>

              </div>
              <button type="submit" class="btn-default w-100" [disabled]="isSubmitting">
                {{ isSubmitting ? 'Registrando criadero...' : 'Registrar criadero' }}
              </button>
            </form>
          </div>
        </div>
      </div>
      <div *ngIf="activeSection === 'verificacion'">
        <div class="card custom-card mx-auto" style="max-width: 600px;">
          <div class="card-header custom-card-header text-center">
            <h3 class="card-title-grande">Estado de la verificaci√≥n</h3>
          </div>
          <div class="card-body custom-card-body text-center">
            <div class="mb-3">
              <span class="badge fs-6 px-2 py-2" [ngClass]="{
                  'badge-verificado': documentacion?.estado === 'ACEPTADO',
                  'badge-pendiente': documentacion?.estado === 'PENDIENTE',
                  'badge-rechazado': documentacion?.estado === 'RECHAZADO',
                  'bg-secondary': !['ACEPTADO', 'PENDIENTE', 'RECHAZADO'].includes(documentacion?.estado)
                }">
                {{ documentacion?.estado || 'No disponible' }}
              </span>
            </div>
            <div class="border rounded bg-white p-2 mt-2"
              *ngIf="documentacion?.motivo && documentacion?.motivo.trim() !== ''">
              <strong>Motivo: </strong>
              <span>{{ documentacion?.motivo }}</span>
            </div>
            <!-- Bot√≥n para reenviar documentaci√≥n si est√° RECHAZADO -->
            <button
              *ngIf="documentacion?.estado === 'RECHAZADO'"
              class="btn-default mt-4"
              (click)="reenviarDocumentacion()"
            >
              Enviar de nuevo la documentaci√≥n
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Modal para error de extensi√≥n de imagen -->
<div class="modal fade" id="modalErrorExtensionImagen" tabindex="-1" aria-labelledby="modalErrorExtensionImagenLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center">
      <div class="modal-header">
        <h5 class="modal-title w-100" id="modalErrorExtensionImagenLabel">Formato de imagen no v√°lido</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <p class="fs-5 mb-0" id="mensajeErrorExtensionImagen"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger w-100" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>